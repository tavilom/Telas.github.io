<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="shortcut icon" href="img/pinheiro.svg" type="image/x-icon" />
    <title>Telas do Figma</title>
    <style>
      :root {
        --gap: 16px;
        /* quantos cards aparecem por vez (muda nos breakpoints) */
        --slides-per-view: 1;
      }

      @media (min-width: 700px) {
        :root {
          --slides-per-view: 2;
        }
      }
      @media (min-width: 1024px) {
        :root {
          --slides-per-view: 3;
        }
      }

      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial,
          sans-serif;
        color: #111;
        background: #fff;
      }

      .wrap {
        padding: var(--gap);
        max-width: 1200px;
        margin: 0 auto;
      }

      /* --- Navbar --- */
      .navbar {
        padding: 12px 0;
        border-bottom: 5px solid #eee;
        border-radius: 0 0 10px 10px;
        background-color: #008c50;
      }
      .h1 {
        font-size: 25px;
        color: #eeeeee;
        font-family: Arial, Helvetica, sans-serif;
        margin: 4px 0 16px;
        padding-left: 15px;
      }

      /* --- Carrossel --- */
      .carousel {
        position: relative;
      }

      .viewport {
        overflow-x: auto;
        overflow-y: hidden;
        -webkit-overflow-scrolling: touch;
        scroll-snap-type: x mandatory;
        scroll-behavior: smooth;
        overscroll-behavior-x: contain;
        padding-bottom: 2px;
      }

      .track {
        display: grid;
        grid-auto-flow: column;
        gap: var(--gap);
        grid-auto-columns: calc(
          (100% - (var(--gap) * (var(--slides-per-view) - 1))) /
            var(--slides-per-view)
        );
        padding: 4px;
      }

      .tile {
        display: flex;
        align-items: center;
        justify-content: center;
        inline-size: 100%;
        aspect-ratio: 16/9;
        padding: 16px;
        border: 3px solid #008c50;
        border-radius: 12px;
        background: #f7f7f8;
        cursor: pointer;
        text-align: center;
        transition: transform 0.05s ease, box-shadow 0.2s ease;
        scroll-snap-align: start;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
      }
      .tile:hover,
      .tile:focus-visible {
        box-shadow: 0 4px 18px rgba(0, 0, 0, 0.08);
        transform: translateY(-2px);
        outline: none;
      }
      .tile span {
        font-weight: 800;
        color: #008c50;
        font-size: 18px;
      }

      .nav {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        border: 0;
        background: rgba(0, 0, 0, 0.55);
        color: #fff;
        width: 40px;
        height: 40px;
        border-radius: 999px;
        cursor: pointer;
        display: grid;
        place-items: center;
        z-index: 2;
      }
      .nav:hover {
        background: rgba(0, 0, 0, 0.7);
      }
      .nav:disabled {
        opacity: 0.4;
        cursor: default;
      }
      .nav.prev {
        left: -6px;
      }
      .nav.next {
        right: -6px;
      }

      .viewport {
        scrollbar-width: none;
        -ms-overflow-style: none;
      }
      .viewport::-webkit-scrollbar {
        width: 0;
        height: 0;
      }

      #viewer-overlay[hidden] {
        display: none;
      }
      #viewer-overlay {
        position: fixed;
        inset: 0;
        background: #000;
        display: grid;
        place-items: center;
        z-index: 9999;
      }
      #viewer {
        width: 100vw;
        height: 100vh;
        border: 0;
        background: #000;
      }
      #close {
        position: fixed;
        top: 12px;
        right: 12px;
        border: 0;
        background: rgba(255, 255, 255, 0.9);
        padding: 8px 12px;
        border-radius: 8px;
        font-size: 14px;
        cursor: pointer;
      }
      #close:hover {
        background: #fff;
      }

      @media (max-width: 600px) {
        .telas {
          font-size: 40px;
        }
      }

      @media (prefers-reduced-motion: reduce) {
        .viewport {
          scroll-behavior: auto;
        }
      }
    </style>
  </head>

  <body>
    <header>
      <nav id="navbar" class="navbar">
        <h1 id="h1" class="h1">Visualizador de protótipos</h1>
      </nav>
    </header>

    <div class="wrap">
      <div class="carousel" aria-label="Carrossel de protótipos">
        <button
          class="nav prev"
          id="prev"
          aria-label="Anterior"
          title="Anterior"
        >
          ‹
        </button>

        <div class="viewport" id="viewport" tabindex="0">
          <div class="track" id="tiles">
            <button
              class="tile"
              data-url="https://embed.figma.com/proto/Yr12PfEGdeRbbHJpeFA6T1/Unimed?node-id=495-1379&p=f&scaling=min-zoom&content-scaling=fixed&page-id=495%3A556&starting-point-node-id=495%3A1379&embed-host=share"
            >
              <span>Oportunidades — Unimed</span>
            </button>

            <button
              class="tile"
              data-url="https://embed.figma.com/proto/Yr12PfEGdeRbbHJpeFA6T1/Unimed?node-id=510-2752&p=f&scaling=min-zoom&content-scaling=fixed&page-id=510%3A1554&embed-host=share"
            >
              <span>OPME</span>
            </button>

            <button
              class="tile"
              data-url="https://embed.figma.com/proto/Yr12PfEGdeRbbHJpeFA6T1/Unimed?node-id=1-2&p=f&scaling=min-zoom&content-scaling=fixed&page-id=0%3A1&starting-point-node-id=1%3A2&embed-host=share"
            >
              <span>Uniservices — Colaboradores</span>
            </button>

            <button
              class="tile"
              data-url="https://embed.figma.com/proto/Yr12PfEGdeRbbHJpeFA6T1/Unimed?node-id=190-563&p=f&scaling=min-zoom&content-scaling=fixed&page-id=190%3A297&starting-point-node-id=190%3A354&embed-host=share"
            >
              <span>Uniservices — Lideranças</span>
            </button>

            <button
              class="tile"
              data-url="https://embed.figma.com/proto/Yr12PfEGdeRbbHJpeFA6T1/Unimed?node-id=319-1140&p=f&scaling=min-zoom&content-scaling=fixed&page-id=319%3A1139&starting-point-node-id=319%3A1140&embed-host=share"
            >
              <span>Uniservices — Admin</span>
            </button>
          </div>
        </div>

        <button class="nav next" id="next" aria-label="Próximo" title="Próximo">
          ›
        </button>
      </div>
    </div>

    <!-- Overlay do Figma -->
    <div id="viewer-overlay" hidden>
      <button id="close" aria-label="Fechar (Esc)">Fechar ✕</button>
      <iframe
        id="viewer"
        title="Preview do Figma"
        allow="fullscreen; clipboard-read; clipboard-write; autoplay"
        allowfullscreen
        referrerpolicy="strict-origin-when-cross-origin"
      ></iframe>
    </div>

    <script>
      const viewport = document.getElementById("viewport");
      const track = document.getElementById("tiles");
      const prevBtn = document.getElementById("prev");
      const nextBtn = document.getElementById("next");

      const prefersReduced = window.matchMedia?.(
        "(prefers-reduced-motion: reduce)"
      ).matches;
      const TOL = 4;

      function getMetrics() {
        const first = track.querySelector(".tile");
        if (!first) return { slide: 0, gap: 0, perView: 1 };
        const slide = first.getBoundingClientRect().width;
        const gap = parseFloat(getComputedStyle(track).gap) || 0;
        const perView =
          parseFloat(
            getComputedStyle(document.documentElement).getPropertyValue(
              "--slides-per-view"
            )
          ) || 1;
        return { slide, gap, perView };
      }

      function isScrollable() {
        return track.scrollWidth > viewport.clientWidth + 1;
      }
      function maxScroll() {
        return Math.max(0, track.scrollWidth - viewport.clientWidth);
      }
      function isAtStart() {
        return viewport.scrollLeft <= TOL;
      }
      function isAtEnd() {
        return viewport.scrollLeft >= maxScroll() - TOL;
      }

      function scrollBySlides(dir) {
        const { slide, gap, perView } = getMetrics();
        const delta = (slide + gap) * perView * dir;
        viewport.scrollBy({
          left: delta,
          behavior: prefersReduced ? "auto" : "smooth",
        });
      }
      function scrollToStart() {
        viewport.scrollTo({
          left: 0,
          behavior: prefersReduced ? "auto" : "smooth",
        });
      }
      function scrollToEnd() {
        viewport.scrollTo({
          left: maxScroll(),
          behavior: prefersReduced ? "auto" : "smooth",
        });
      }

      function updateNav() {
        const canScroll = isScrollable();
        prevBtn.disabled = nextBtn.disabled = !canScroll;
      }

      prevBtn.addEventListener("click", () => {
        if (!isScrollable()) return;
        if (isAtStart()) {
          scrollToEnd();
        } else {
          scrollBySlides(-1);
        }
      });

      nextBtn.addEventListener("click", () => {
        if (!isScrollable()) return;
        if (isAtEnd()) {
          scrollToStart();
        } else {
          scrollBySlides(1);
        }
      });

      viewport.addEventListener("scroll", () =>
        requestAnimationFrame(updateNav)
      );
      window.addEventListener("resize", updateNav);
      updateNav();

      let isPointerDown = false;
      let startX = 0;
      let startScroll = 0;

      viewport.addEventListener("pointerdown", (e) => {
        if (!isScrollable()) return;
        isPointerDown = true;
        startX = e.clientX;
        startScroll = viewport.scrollLeft;
        viewport.setPointerCapture(e.pointerId);
        viewport.style.cursor = "grabbing";
      });
      viewport.addEventListener("pointermove", (e) => {
        if (!isPointerDown) return;
        const dx = e.clientX - startX;
        viewport.scrollLeft = startScroll - dx;
      });
      function endDrag() {
        isPointerDown = false;
        viewport.style.cursor = "";
      }
      viewport.addEventListener("pointerup", endDrag);
      viewport.addEventListener("pointercancel", endDrag);
      viewport.addEventListener("mouseleave", endDrag);

      // Teclado: setas esquerda/direita com loop
      viewport.addEventListener("keydown", (e) => {
        if (e.key === "ArrowRight") {
          e.preventDefault();
          if (isAtEnd()) scrollToStart();
          else scrollBySlides(1);
        } else if (e.key === "ArrowLeft") {
          e.preventDefault();
          if (isAtStart()) scrollToEnd();
          else scrollBySlides(-1);
        }
      });

      const overlay = document.getElementById("viewer-overlay");
      const viewer = document.getElementById("viewer");
      const closeBtn = document.getElementById("close");

      function openViewer(url) {
        viewer.src = url;
        overlay.hidden = false;

        const el = overlay;
        if (el.requestFullscreen) {
          el.requestFullscreen().catch(() => {});
        }
      }

      function closeViewer() {
        viewer.src = "about:blank";
        overlay.hidden = true;
        if (document.fullscreenElement && document.exitFullscreen) {
          document.exitFullscreen().catch(() => {});
        }
      }

      track.addEventListener("click", (e) => {
        const btn = e.target.closest("[data-url]");
        if (!btn) return;
        openViewer(btn.dataset.url);
      });

      closeBtn.addEventListener("click", closeViewer);
      document.addEventListener("keydown", (e) => {
        if (e.key === "Escape") closeViewer();
      });
    </script>
  </body>
</html>
